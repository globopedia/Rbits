<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Partidos por Árbitro</title>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/PapaParse/5.4.1/papaparse.min.js"></script>
  <link href="https://fonts.googleapis.com/css2?family=MuseoModerno:wght@500&display=swap" rel="stylesheet">
  <style>
    body { font-family: 'MuseoModerno', sans-serif; background:#fff; color:#222; margin:20px; }
    h1 { color:#FF0000; text-align:center; }
    .logo { display:block; margin:0 auto 10px; width:100px; }
    input[type="text"] {
      padding:8px; border-radius:8px; border:2px solid #FF0000;
      font-size:16px; margin: 0 auto 20px; display:block; width: 90%; max-width:400px;
    }
    .partido-card {
      border:1px solid #ccc; border-radius:6px;
      padding:6px; margin:8px auto;
      background:#fafafa; font-size:14px; text-align:center; max-width:600px;
    }
    .resultado1-box, .resultado2-box {
      display:inline-block; width:16px; height:28px;
      font-size:32px; font-weight:bold; line-height:28px;
      text-align:center; margin:2px; padding:10px 10px;
      border:3px solid #FF0000; border-radius:6px;
      background:#fff5f5; vertical-align:middle; min-width:26px;
    }
    .escudo-huracan, .escudo-rival {
      width:50px; height:50px; object-fit:contain;
      vertical-align:middle;
    }
    .resultado-con-escudo { display:flex; align-items:center; gap:6px; flex-wrap:wrap; justify-content:center; }
  </style>
</head>
<body>
  <img src="https://globopedia.github.io/buscador-partidos/logo_globopedia.png" alt="Logo Huracán" class="logo" />
  <h1>⚖️ Partidos por Árbitro</h1>

  <input type="text" id="buscadorArbitro" placeholder="Filtrar por nombre de árbitro..."/>

  <div id="resultados"></div>

  <script>
    const partidosURL = "https://globopedia.github.io/buscador-partidos/Encuentros_Huracan.csv?v=" + Date.now();
    let encuentros = [];

    const norm = (t) =>
      (t || "").toString().normalize("NFD").replace(/[\u0300-\u036f]/g, "").trim().toLowerCase();

    Papa.parse(partidosURL, {
      download: true,
      header: true,
      skipEmptyLines: true,
      complete: function(results) {
        encuentros = results.data.map(p => ({
          Club:       (p.Club ?? "").trim(),
          Torneo:     (p.Torneo ?? "").trim(),
          Condición:  (p.Condición ?? "").trim(),
          Situación:  (p.Situación ?? "").trim(),
          Fecha:      (p.Fecha ?? "").trim(),
          Resultado1: (p.Resultado1 ?? "").trim(),
          Resultado2: (p.Resultado2 ?? "").trim(),
          Rival:      (p.Rival ?? "").trim(),
          Huracán:    (p.Huracán ?? "").trim(),
          Estadio:    (p.Estadio ?? "").trim(),
          Árbitro:    (p.Árbitro ?? "").trim(),
          Incidencias:(p.Incidencias ?? "").trim()
        }));
      }
    });

    document.getElementById("buscadorArbitro").addEventListener("input", function() {
      const filtro = norm(this.value);
      const resultados = document.getElementById("resultados");
      resultados.innerHTML = "";

      if (!filtro) return;

      const filtrados = encuentros.filter(p => norm(p.Árbitro).includes(filtro));

      if (filtrados.length === 0) {
        resultados.innerHTML = "<p>No se encontraron partidos con ese árbitro.</p>";
        return;
      }

      filtrados.forEach(p => {
        const card = document.createElement("div");
        card.className = "partido-card";

        let marcador = "";
        if (p.Condición.toLowerCase() === "visitante") {
          marcador = `
            <img class="escudo-rival" src="https://globopedia.github.io/buscador-partidos/escudos/${p.Club}.png" alt="${p.Club}">
            <div class="resultado2-box">${p.Resultado2}</div>
            <div class="resultado1-box">${p.Resultado1}</div>
            <img class="escudo-huracan" src="https://globopedia.github.io/buscador-partidos/escudos/Huracán.png" alt="Huracán">
          `;
        } else {
          marcador = `
            <img class="escudo-huracan" src="https://globopedia.github.io/buscador-partidos/escudos/Huracán.png" alt="Huracán">
            <div class="resultado1-box">${p.Resultado1}</div>
            <div class="resultado2-box">${p.Resultado2}</div>
            <img class="escudo-rival" src="https://globopedia.github.io/buscador-partidos/escudos/${p.Club}.png" alt="${p.Club}">
          `;
        }

        card.innerHTML = `
          <div class="resultado-con-escudo">${marcador}</div>
          <div><b>${p.Fecha}</b> - ${p.Torneo}</div>
          <div><b>Estadio:</b> ${p.Estadio}</div>
          <div><b>Árbitro:</b> ${p.Árbitro}</div>
          <div><b>Huracán:</b> ${p.Huracán}</div>
          <div><b>${p.Club}:</b> ${p.Rival}</div>
          <div><b>Incidencias:</b> ${p.Incidencias}</div>
        `;

        resultados.appendChild(card);
      });
    });
  </script>
</body>
</html>
